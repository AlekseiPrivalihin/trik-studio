<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="keywords" content="TRIKStudio, help, manual, user guide" />
<meta name="description" content="TRIKStudio help center" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>Программирование Lego NXT в TRIKStudio</title>
<link href="style.css" rel="stylesheet" type="text/css" media="screen" />
<script type="text/javascript" src="version.js"></script>
</head>

<!-- TODO: move contents, header and footer into common separate files -->
<body>
<div id="wrapper">
	<script type="text/javascript" src="header.html.js"></script>
	<div id="page" class="container">
		<div id="sidebar">
			<script type="text/javascript" src="contents.html.js"></script>
		</div>		
		<div id="content">
			<div class="post">
				<h2 class="title">Программирование Lego NXT в TRIKStudio<a href="#"></a></h2>
				<div class="entry">
					<p></p>
				</div>
			</div>
			
			<h3><a name="connection">Подключение робота</a></h3>

			<h4>Подключение по USB</h4>

			<p>
			Для управления роботом прямыми командами по USB и для загрузки программ на робот потребуются драйвера из поставки конструктора. Скачать их отдельно можно с сайта Lego:
			<a href="http://www.lego.com/ru-ru/mindstorms/downloads">http://www.lego.com/ru-ru/mindstorms/downloads</a>, "Загрузить драйвер NXT Fantom". Если при установке возникнут проблемы, 
			можно в распакованном архиве с драйвером перейти в папку "NXT Fantom Drivers\NXT Fantom Drivers\Windows\1.2\1.2.0\Products", выбрать там нужный драйвер и запустить соответствующий .msi-файл вручную 
			(например, для 64-битной Windows 8.1 это "NXT Fantom Drivers\NXT Fantom Drivers\Windows\1.2\1.2.0\Products\LEGO_NXT_Driver_64\NXT_D02\LegoMindstormsNXTdriver64.msi"). Информацию об установке
			драйвера NXT можно уточнить на сайте Lego или в сторонних источниках, авторы данной документации не связаны с Lego и не могут влиять на то, как Lego распространяет драйвера.
			</p>
			
			<p>
			После установки драйверов TRIKStudio сможет подключаться к роботу. Задайте в окне настроек робота подключение по USB, нажмите "ОК". 
			</p>

			<center><img src="pics/nxt-select-connection-type.png" alt="Выбор способа соединения" width="660" height="420"></center>
			
			<p>
			Нажмите кнопку "Подключиться" на панели инструментов.
			</p>
			
			<center><img src="pics/nxt-connect.png" alt="Кнопка подключения"></center>

			<p>
			В окне вывода должно появиться сообщение об успешном подключении, после этого робот готов к работе.
			</p>
			
			<center><img src="pics/nxt-connection-success.png" alt="Успешное подключение"></center>

			<h4>Подключение по Bluetooth</h4>

			<p>
			Робот подключается к компьютеру по Bluetooth как обычное Bluetooth-устройство, поэтому, во-первых, никаких специальных драйверов робота для подключения не требуется, во-вторых, процесс 
			подключения сильно зависит как от операционной системы, так и от драйверов конкретного Bluetooth-адаптера. Ниже приведены инструкции по настройке подключения для Windows Vista с 
			использованием встроенных в ОС драйверов для Generic Bluetooth Radio
			</p>
			
			<ol>
				<li> Включить робот </li>
				<li> В "панели управления" операционной системы надо найти значок "Устройства Bluetooth"</li>
				<li> Нажать "Добавление беспроводного устройства" </li>
				<li> Выбрать в появившемся окне устройство "NXT" </li>
				<li> Нажать на роботе оранжевую кнопку, подтвердив пароль <i><b>1234</b></i> на Bluetooth-соединение</li>
				<li> В появившемся на компьютере окне ввести код <b><i>1234</b></i> и нажать "Далее"</li>
				<li> Нажать "Закрыть"</li>
				<li> Правой кнопкой мыши кликнуть по значку устройства, выбрать пункт меню "Свойства"</li>
				<li> В появившемся окне перейти на вкладку "Службы" и запомнить номер последовательного порта (например, <i>COM7</i>)</li>
				<li> Закрыть окно и панель управления, теперь робот подключен как Bluetooth-устройство, надо настроить TRIKStudio</li>
				<li> Запустить TRIKStudio, открыть окно настроек робота</li>
				<li> Выбрать подключение по Bluetooth и реальный робот</li>
				<li> В разделе "Настройки Bluetooth" указать номер COM-порта, который был написан во вкладке "Службы" (например, <i>COM7</i>)</li>
				<li> Нажать "ОК"</li>
			</ol>
			
			<p>
			А вот так выполняется подключение в WIndows 8.1 со стандартным драйвером Bluetooth. Сначала на панели, появляющейся у правого края экрана надо выбрать "Параметры":
			</p>
			
			<center><img src="pics/nxt-8-sidebar.png" alt="Выбор пункта 'Параметры'"></center>

			<p>
			Там выбираем "Изменение параметров компьютера":
			</p>
			
			<center><img src="pics/nxt-8-sidebar-2.png" alt="Выбор пункта 'Изменение параметров компьютера'"></center>
			
			<p>
			В появившемся окне выбираем "Компьютер и устройства":
			</p>
			
			<center><img src="pics/nxt-8-parameters.png" alt="Выбор 'Компьютер и устройства'"></center>

			<p>
			Там выбираем "Bluetooth" и находим в списке Bluetooth-устройств устройство с именем NXT (заполнение списка может занять некоторое время):
			</p>
			
			<center><img src="pics/nxt-8-bluetooth.png" alt="Выбор 'Bluetooth'"></center>
			
			<p>
			Жмём кнопку "Связать", на роботе в это время должен отобразиться ввод пароля Bluetooth-соединения. Можно оставить пароль по умолчанию и нажать оранжевую кнопку. После этого окно ввода пароля должно появиться
			и на компьютере. Пароль по умолчанию – 1234:
			</p>
			
			<center><img src="pics/nxt-8-password.png" alt="Ввод пароля"></center>
			
			<p>
			Если всё было сделано правильно, рядом с именем устройства должна появиться надпись "Подключено":
			</p>
			
			<center><img src="pics/nxt-8-bluetooth-connected.png" alt="Подключено"></center>
			
			<p>
			После этого можно проделать следующие пункты:
			<ol>
				<li> Запустить TRIKStudio, открыть окно настроек робота</li>
				<li> Выбрать подключение по Bluetooth и реальный робот</li>
				<li> В разделе "Настройки Bluetooth" выбрать один из COM-портов из выпадающего списка (например, <i>COM7</i>)</li>
				<li> Нажать "ОК"</li>
				<li> Попробовать выполнить подключение к роботу с посощью кнопки "Подключиться" на панели инструментов</li>
				<li> Если подключение не удалось, попробовать другой COM-порт в настройках</li>
			</ol>
			</p>

			<p>
			См. также раздел <a href="interface.html#robotSettings">Диалог настроек робота</a>.
			</p>

			<h3><a name="flashing">Прошивка робота</a></h3>
			
			<p>
			TRIKSdudio в качестве среды выполнения сгенерированных программ использует прошивку nxtOSEK (<a href="http://lejos-osek.sourceforge.net/">http://lejos-osek.sourceforge.net/</a>), совместимую по формату
			команд и внешнему виду интерфейса с штатной прошивкой, но позволяющую запускать программы на C с библиотекой ECRobot. Перед тем, как загружать на робот сгенерированные программы, робот необходимо прошить
			(сделать это надо только один раз для каждого робота, если не используется сторонних средств, загружающих на робот свои прошивки).
			</p>
			
			<p>
			Так же, как и для подключения по USB, прошивка робота требует установленных драйверов (<a href="http://www.lego.com/ru-ru/mindstorms/downloads">http://www.lego.com/ru-ru/mindstorms/downloads</a>).
			Первое, что требуется сделать – перевести робот в режим прошивания, для этого надо включить робот, подключить его к компьютеру по USB, после чего чем-нибудь тонким (скрепкой, стержнем от ручки) 
			нажать на кнопку Reset сзади робота и подержать 4 секунды (подробнее об этом см. в инструкции по эксплуатации робота, поставляемой вместе с конструктором). Если всё сделано правильно, 
			робот будет характерно тикать. После этого необходимо нажать на кнопку "Прошить" и подождать, пока система сообщит об удачном завершении прошивания робота. После этого робот можно выключить 
			и снова включить, загрузится новая прошивка.
			</p>
			
			<h3><a name="blocks">Специальные блоки</a></h3>
			
			<p>
			Специализированные блоки для Lego NXT делятся на несколько категорий:
			</p>
			
			<ul>
				<li><b><a href="#nxt-functional-blocks">Действия</a></b> – блоки, выполняющие какое-либо действие на роботе: включение моторов, проигрывание звука и т.д.</li>
				<li><b><a href="#nxt-waiting-blocks">Ожидание</a></b> – блоки, ждущие наступления какого-либо события: определённых показаний датчиков, нажатия на кнопку и т.д.</li> 
				<li><b><a href="#nxt-drawing-blocks">Рисование на дисплее</a></b> – блоки, используемые для вывода графики и текста на экран.</li>
			</ul>
			
			<h4><a name="nxt-functional-blocks">Действия</a></h4>

			<table cellspacing="2" border="1" cellpadding="5" width="800" >
				<tr>
					<td><b>Название элемента</b></td>
					<td><b>Пиктограмма</b></td>
					<td><b>Описание</b></td>
				</tr>
				<tr>
					<td>Гудок</td>
					<td><center><img src="pics/nxt-beepBlock.png" alt="Гудок"></center></td>
					<td>Проиграть на роботе звук с фиксированной частотой. Имеется один параметр — ждать ли завершения проигрывания звука или сразу же перейти к следующему блоку. Допустимые значения — Истина и Ложь.</td>
				</tr>
				<tr>
					<td>Играть звук</td>
					<td><center><img src="pics/nxt-toneBlock.png" alt="Играть звук"></center></td>
					<td>Проиграть на роботе звук с заданной частотой и длительностью. Аналогичен блоку "Гудок", но позволяет задавать параметры звука. Имеется параметр, определяющий, ждать ли завершения проигрывания звука или сразу же перейти к следующему блоку. </td>
				</tr>
				<tr>
					<td>Моторы вперёд</td>
					<td><center><img src="pics/nxt-enginesForwardBlock.png" alt="Моторы вперёд"></center></td>
					<td>Включить моторы по заданным портам с заданной мощностью. Порты задаются буквами A, B или C, разделенными запятыми. Мощность задается в процентах числом от -100 до 100, если задано отрицательное значение, мотор включается в режиме реверса. Так, на картинке изображена команда включения моторов на портах A и B с мощностью 100%. Кроме того, моторы имеют разные режимы работы: режим торможения и режим скольжения (отображаемые красным или зелёным прямоугольником на блоке соответственно). Режимы влияют на то, как двигатель отрабатывает команду — режим торможения стопорит двигатель при отключении, режим скольжения позволяет двигателю прокручиваться по инерции. 
					</td>
				</tr>
				<tr>
					<td>Моторы назад</td>
					<td><center><img src="pics/nxt-enginesBackwardBlock.png" alt="Моторы назад"></center></td>
					<td>Включить моторы в режиме реверса по заданным портам с заданной мощностью. Параметры аналогичны параметрами блока "Моторы вперёд".</td>
				</tr>
				<tr>
					<td>Моторы стоп</td>
					<td><center><img src="pics/nxt-enginesStopBlock.png" alt="Моторы стоп"></center></td>
					<td>Выключить моторы по заданным портам.</td>
				</tr>
				<tr>
					<td>Сбросить показания энкодера</td>
					<td><center><img src="pics/nxt-clearEncoderBlock.png" alt="Сбросить показания энкодера"></center></td>
					<td>Сбросить показания количества оборотов моторов.</td>
				</tr>
			</table>

			<br/>

			<h4><a name="nxt-waiting-blocks">Ожидания</a></h4>

			<table cellspacing="2" border="1" cellpadding="5" width="800" >
				<tr>
					<td><b>Название элемента</b></td>
					<td><b>Пиктограмма</b></td>
					<td><b>Описание</b></td>
				</tr>
				<tr>
					<td>Ждать сенсор касания</td>
					<td><center><img src="pics/nxt-waitTouchBlock.png" alt="Ждать сенсор касания"></center></td>
					<td>Ждать, пока не сработает датчик касания. Параметром указывается номер порта, к которому подключен датчик. Допустимые значения: 1, 2, 3, 4.</td>
				</tr>
				<tr>
					<td>Ждать сонар</td>
					<td><center><img src="pics/nxt-waitSonarBlock.png" alt="Ждать сонар"></center></td>
					<td>Ждать, пока расстояние, возвращаемое ультразвуковым сенсором расстояния, не будет сравнимо с указанным в значении параметра "Расстояние" (расстояние задается в сантиметрах, от 0 до 255). Еще один парамер — номер порта, к которому подключен датчик расстояния. Также параметром указывается операция, которая будет использоваться для сравнения с введенным расстоянием. Так, при выполнении приведенного блока выполнение программы остановится до тех пор, пока значение, возвращаемое сонаром, не будет больше, чем 40 см.</td>
				</tr>



				<td>Ждать интенсивность цвета</td>
				<td><center><img src="pics/nxt-waitIntensityBlock.png" alt="Ждать интенсивность цвета"></center></td>
				<td>Ждать, пока значение, возвращаемое сенсором цвета на указанном порту, не будет сравнимо с указанным в значении параметра "Интенсивность" (задается в процентах). Еще один парамер — номер порта, к которому подключен сенсор цвета. Также параметром указывается операция, которая будет использоваться для сравнения с введенной интенсивностью. Так, при выполнении приведенного блока выполнение программы остановится до тех пор, пока значение, возвращаемое соответствующим сенсором цвета, не будет больше, чем 60 процентов.</td>
				</tr>
				<td>Ждать нажатия кнопок</td>
				<td><center><img src="pics/nxt-waitForButtonsBlock.png" alt="Ждать нажатия кнопок"></center></td>
				<td>Ждать, пока заданные кнопки на роботе не будут нажаты заданное количество раз. Счётчики нажатия можно задать для каждой кнопки отдельно, блок продолжит выполнение, только когда все счётчики сработают.</td>
				</tr>
				<tr>
				<td>Ждать свет</td>
				<td><center><img src="pics/nxt-waitLightBlock.png" alt="Ждать свет"></center></td>
				<td>Ждать, пока значение, возвращаемое сенсором света на указанном порту, не будет сравнимо с указанным в значении параметра "Проценты". Еще один парамер — номер порта, к которому подключен сенсор цвета. Также параметром указывается операция, которая будет использоваться для сравнения со значением параметра "Проценты". Так, при выполнении приведенного блока выполнение программы остановится до тех пор, пока значение, возвращаемое соответствующим сенсором света, не будет больше, чем 60 процентов.</td>
				</tr>
				<tr>
				<td>Ждать сенсор звука</td>
				<td><center><img src="pics/nxt-waitSoundBlock.png" alt="Ждать сенсор звука"></center></td>
				<td>Ждать, пока громкость, считанная микрофоном на заданном порту, не будет выше или ниже заданного значения.</td>
				</tr>			  


				<tr>
				<td>Ждать цвет</td>
				<td><center><img src="pics/nxt-waitColorBlock.png" alt="Ждать цвет"></center></td>
				<td>Ждать, пока сенсор цвета в режиме распознавания цветов не вернет указанный цвет.</td>
				</tr>
				<tr>
				<td>Ждать энкодер</td>
				<td><center><img src="pics/nxt-waitEncoderBlock.png" alt="Ждать энкодер"></center></td>
				<td>Ждать, пока показания счетчика количества оборотов на заданном моторе не достинут указанного в значении параметра "Предел оборотов".</td>
				</tr>
				<tr>
				<td>Таймер</td>
				<td><center><img src="pics/nxt-timerBlock.png" alt="Таймер"></center></td>
				<td>Ждать заданное количество времени, в миллисекундах.</td>
				</tr>
			</table>

			<br/>

			<h4><a name="nxt-drawing-blocks">Рисование на дисплее</a></h4>
			
			Блоки рисования на дисплее работают только при прошивке программы на робот или в двумерной модели, при интерпретации программы по Bluetooth или USB они работать не будут в силу ограничений в системе прямых команд робота.

			<table cellspacing="2" border="1" cellpadding="5" width="800" >
			  <tr>
				<td><b>Название элемента</b></td>
				<td><b>Пиктограмма</b></td>
				<td><b>Описание</b></td>
			  </tr>
			  <tr>
				<td>Напечатать текст</td>
				<td><center><img src="pics/nxt-displayTextBlock.png" alt="Напечатать текст"></center></td>
				<td>Напечатать заданную строку в заданных координатах на экране. Можно использовать символ доллара ('$') перед идентификатором переменной для вывода ее значения. Данный сценарий игнорируется, если перед символом доллара стоит обратный слеш ('\'). Пример: строка "\$a = $a" напечатает "$a = 5", если значение переменной a равно 5. </td>
			  </tr>
			  <tr>
				<td>Нарисовать круг</td>
				<td><center><img src="pics/nxt-drawCircleBlock.png" alt="Нарисовать круг"></center></td>
				<td>Нарисовать на экране круг с заданным центром и заданным радиусом.</td>
			  </tr>
			  <tr>
				<td>Нарисовать линию</td>
				<td><center><img src="pics/nxt-drawLineBlock.png" alt="Нарисовать линию"></center></td>
				<td>Нарисовать на экране отрезок. В качестве параметров блоку указываются концы отрезка.</td>
			  </tr>
			  <tr>
				<td>Нарисовать прямоугольник</td>
				<td><center><img src="pics/nxt-drawRectangleBlock.png" alt="Нарисовать прямоугольник"></center></td>
				<td>Нарисовать на экране прямоугольник. В качестве параметров указываются координаты левого верхнего угла, ширина и высота прямоугольника.</td>
			  </tr>
			  <tr>
				<td>Нарисовать точку</td>
				<td><center><img src="pics/nxt-drawPointBlock.png" alt="Нарисовать точку"></center></td>
				<td>Нарисовать на экране точку в указанных координатах.</td>
			  </tr>
			  <tr>
				<td>Очистить экран</td>
				<td><center><img src="pics/nxt-clearScreenBlock.png" alt="Очистить экран"></center></td>
				<td>Стереть всё, что нарисовано на экране.</td>
			  </tr>
			</table>
		</div>
		<!-- end #content -->
		<div style="clear: both;">&nbsp;</div>
	</div>
	<!-- end #page -->
</div>
<script type="text/javascript" src="footer.html.js"></script>
</body>
</html>
